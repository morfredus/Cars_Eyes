<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cars Eyes: Interface Web et R√©seau</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Cars Eyes
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_docs_2_w_e_b___u_i___f_r.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Interface Web et R√©seau </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md435"></a></p>
<p><b>Version:</b> 1.6.2 <br  />
 <b>Version minimale:</b> 1.6.2 <br  />
 <b>Langage:</b> Fran√ßais <br  />
</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md436"></a>
Vue d'ensemble</h1>
<p>Le syst√®me inclut un serveur web embarqu√© sur le port <b>80</b>. Endpoints principaux :</p><ul>
<li><span class="tt">GET /</span> ‚Äî Tableau de bord HTML avec stats syst√®me et contr√¥les d'animations</li>
<li><span class="tt">GET /status</span> ‚Äî API JSON pour acc√®s programmatique</li>
<li><span class="tt">GET /api/eyes/off</span> ‚Äî √âteindre compl√®tement toutes les LEDs et arr√™ter toutes animations jusqu'√† l'appui d'un autre bouton</li>
<li><span class="tt">GET /api/eyes/animation?id=X</span> ‚Äî D√©finir l'animation (0-16)</li>
<li><span class="tt">GET /api/eyes/brightness?value=X</span> ‚Äî D√©finir la luminosit√© (0-255)</li>
<li><span class="tt">GET /api/eyes/scheme?id=X</span> ‚Äî D√©finir le sch√©ma de couleur (0-4)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md437"></a>
Acc√©der √† l'interface</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md438"></a>
Par adresse IP</h2>
<p>Trouver l'IP sur l'√©cran LCD ou moniteur s√©rie : </p><div class="fragment"><div class="line">http://192.168.x.x/</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md439"></a>
Par nom mDNS</h2>
<p>Nom d'h√¥te par d√©faut : <span class="tt">cars-eyes</span> (√©ditable dans <span class="tt"><a class="el" href="config_8h.html" title="Param√®tres utilisateur centralis√©s pour l&#39;application.">config.h</a></span>) : </p><div class="fragment"><div class="line">http://cars-eyes.local/</div>
</div><!-- fragment --><p><b>Note :</b> mDNS n√©cessite support du domaine <span class="tt">.local</span> (macOS/Linux g√©n√©ralement OK ; Windows peut n√©cessiter Bonjour).</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md440"></a>
Tableau de bord</h1>
<p>La page HTML affiche :</p><ul>
<li><b>Processeur</b> ‚Äî Mod√®le de puce (ex. "ESP32-S3")</li>
<li><b>CPU</b> ‚Äî Fr√©quence en MHz</li>
<li><b>Heap</b> ‚Äî M√©moire SRAM libre et totale</li>
<li><b>PSRAM</b> ‚Äî RAM externe libre et totale (S3 uniquement)</li>
<li><b>SSID</b> ‚Äî Nom du r√©seau WiFi connect√©</li>
<li><b>IP</b> ‚Äî Adresse IP de l'appareil</li>
<li><b>OTA</b> ‚Äî Bouton vers la page de mise √† jour OTA</li>
</ul>
<p>Toutes les valeurs se mettent √† jour au chargement. Responsive, fonctionne sur navigateurs mobiles.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md441"></a>
Page de mise √† jour OTA (<span class="tt">/update</span>)</h1>
<ul>
<li>Accessible via le bouton OTA du tableau de bord ou directement <span class="tt"><a href="http://">http://</a>&lt;hote&gt;/update</span></li>
<li>Envoyer un fichier <span class="tt">.bin</span> compil√© ; une barre de progression s'affiche</li>
<li>Au succ√®s, l'appareil red√©marre automatiquement et revient sur le tableau de bord</li>
<li>Garder le PC et l'ESP32 sur le m√™me WiFi ; utiliser un signal stable pour les gros uploads</li>
<li>S√©curit√© : aucune authentification par d√©faut ; ne pas exposer cet endpoint sur un r√©seau non fiable</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md442"></a>
API JSON Status</h1>
<p>Endpoint : <span class="tt"><a href="http://cars-eyes.local/status">http://cars-eyes.local/status</a></span></p>
<p>Exemple de r√©ponse : </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;project&quot;: &quot;Cars Eyes&quot;,</div>
<div class="line">  &quot;version&quot;: &quot;1.3.2&quot;,</div>
<div class="line">  &quot;chip&quot;: &quot;ESP32-S3&quot;,</div>
<div class="line">  &quot;cpu_mhz&quot;: 240,</div>
<div class="line">  &quot;heap_free&quot;: 256000,</div>
<div class="line">  &quot;heap_total&quot;: 320000,</div>
<div class="line">  &quot;psram_free&quot;: 8000000,</div>
<div class="line">  &quot;psram_total&quot;: 8388608,</div>
<div class="line">  &quot;ssid&quot;: &quot;MonR√©seau&quot;,</div>
<div class="line">  &quot;ip&quot;: &quot;192.168.1.100&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Utiliser pour logger des donn√©es, monitorer √† distance, ou d√©clencher alertes.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md443"></a>
Personnaliser le tableau de bord</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md444"></a>
Changer titre et couleurs</h2>
<p>√âditer <span class="tt">buildRootPage()</span> dans <span class="tt"><a class="el" href="main_8cpp.html" title="Point d&#39;entr√©e principal du projet Cars Eyes.">src/main.cpp</a></span> : </p><div class="fragment"><div class="line">html += <span class="stringliteral">&quot;&lt;title&gt;Mon appareil IoT&lt;/title&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;body{background:linear-gradient(135deg,#1a1a2e,#16213e);...}&quot;</span>;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md445"></a>
Ajouter une nouvelle carte de stats</h2>
<div class="fragment"><div class="line">html += <span class="stringliteral">&quot;&lt;div class=\&quot;card\&quot;&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;&lt;strong&gt;Ma Stat&lt;/strong&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;&lt;div&gt;&quot;</span> + String(maValeur) + <span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md446"></a>
Changer style des cartes</h2>
<p>√âditer CSS dans <span class="tt">buildRootPage()</span> : </p><div class="fragment"><div class="line">html += <span class="stringliteral">&quot;.card{background:#0b1220;border:2px solid #green;...}&quot;</span>;</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md447"></a>
Monitoring et collecte de donn√©es</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md448"></a>
Interroger l'endpoint JSON</h2>
<div class="fragment"><div class="line"># Exemple Bash</div>
<div class="line">while true; do</div>
<div class="line">  curl -s http://cars-eyes.local/status | jq .</div>
<div class="line">  sleep 10</div>
<div class="line">done</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md449"></a>
Envoyer vers le cloud</h2>
<p>Ajouter √† <span class="tt"><a class="el" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Boucle principale Arduino. G√®re les t√¢ches p√©riodiques et le serveur web.">loop()</a></span> : </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lastLog = 0;</div>
<div class="line"><span class="keywordflow">if</span> (WiFi.isConnected() &amp;&amp; millis() - lastLog &gt; 60000) {</div>
<div class="line">    lastLog = millis();</div>
<div class="line">    String json = buildStatusJson();</div>
<div class="line">    <span class="comment">// Envoyer json √† votre serveur</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md450"></a>
D√©clencher selon conditions</h2>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (ESP.getFreeHeap() &lt; 50000) {</div>
<div class="line">    Serial.println(<span class="stringliteral">&quot;Alerte m√©moire basse!&quot;</span>);</div>
<div class="line">    <span class="comment">// Envoyer alerte</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md451"></a>
Configuration WiFi</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md452"></a>
Ajouter/supprimer r√©seaux</h2>
<p>√âditer <span class="tt"><a class="el" href="secrets_8h.html" title="Stockage des identifiants sensibles (WiFi, API, etc.).">include/secrets.h</a></span> : </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_variable" href="secrets_8h.html#a91c5976659d2c632043669eee67a0b2d">WIFI_NETWORKS</a>[][2] = {</div>
<div class="line">    {<span class="stringliteral">&quot;Maison&quot;</span>, <span class="stringliteral">&quot;motdepasse1&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;Bureau&quot;</span>, <span class="stringliteral">&quot;motdepasse2&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;Mobile&quot;</span>, <span class="stringliteral">&quot;motdepasse3&quot;</span>}</div>
<div class="line">};</div>
<div class="ttc" id="asecrets_8h_html_a91c5976659d2c632043669eee67a0b2d"><div class="ttname"><a href="secrets_8h.html#a91c5976659d2c632043669eee67a0b2d">WIFI_NETWORKS</a></div><div class="ttdeci">const char * WIFI_NETWORKS[][2]</div><div class="ttdef"><b>Definition</b> secrets.h:15</div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md453"></a>
Ajuster d√©lai de connexion</h2>
<p>√âditer <span class="tt"><a class="el" href="config_8h.html" title="Param√®tres utilisateur centralis√©s pour l&#39;application.">include/config.h</a></span> : </p><div class="fragment"><div class="line">.wifiConnectTimeoutMs = 12000,  <span class="comment">// 12 secondes par tentative</span></div>
<div class="line">.maxWifiAttempts = 10,           <span class="comment">// Essayer jusqu&#39;√† 10 fois</span></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md454"></a>
Connexion manuelle</h2>
<p>Le syst√®me utilise <span class="tt">WiFiMulti</span> qui essaie tous les r√©seaux configur√©s. V√©rifier statut WiFi : </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (WiFi.isConnected()) {</div>
<div class="line">    Serial.println(<span class="stringliteral">&quot;SSID: &quot;</span> + String(WiFi.SSID()));</div>
<div class="line">    Serial.println(<span class="stringliteral">&quot;IP: &quot;</span> + WiFi.localIP().toString());</div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md455"></a>
D√©pannage mDNS</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md456"></a>
Nom ne r√©sout pas</h2>
<ul>
<li>V√©rifier mDNS activ√© dans config : <span class="tt">.mdnsHost = "esp32-template"</span></li>
<li>Routeur ne bloque pas mDNS (port 5353 UDP)</li>
<li>Essayer <span class="tt">ping esp32-template.local</span> (ajouter <span class="tt">.local</span> si n√©cessaire)</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md457"></a>
Nom d'h√¥te diff√©rent</h2>
<p>√âditer <span class="tt"><a class="el" href="config_8h.html" title="Param√®tres utilisateur centralis√©s pour l&#39;application.">config.h</a></span> : </p><div class="fragment"><div class="line">.mdnsHost = <span class="stringliteral">&quot;mon-appareil&quot;</span>  <span class="comment">// Accessible sur mon-appareil.local</span></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md458"></a>
Notes de s√©curit√©</h1>
<p><b>Le serveur web du template N'A PAS d'authentification.</b> Si expos√© sur un r√©seau non fiable :</p><ul>
<li>D√©sactiver web UI : <span class="tt">enableWebUi = false</span> dans <span class="tt"><a class="el" href="config_8h.html" title="Param√®tres utilisateur centralis√©s pour l&#39;application.">config.h</a></span></li>
<li>OU restreindre acc√®s au routeur/pare-feu</li>
<li>OU ajouter authentification HTTP (non impl√©ment√©e par d√©faut)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md459"></a>
Performance</h1>
<ul>
<li>Serveur web s'ex√©cute sur <b>core 0</b> avec WiFi</li>
<li>Boucle firmware aussi active ; r√©activit√© d√©pend de complexit√©</li>
<li>Endpoint JSON l√©ger ; utilisable pour interrogation fr√©quente</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md460"></a>
Avanc√© : Ajouter endpoints personnalis√©s</h1>
<div class="fragment"><div class="line"><a class="code hl_function" href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a>.on(<span class="stringliteral">&quot;/api/temperature&quot;</span>, HTTP_GET, []() {</div>
<div class="line">    String json = <span class="stringliteral">&quot;{\&quot;temp\&quot;:&quot;</span> + String(getTemperature()) + <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line">    <a class="code hl_function" href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a>.send(200, <span class="stringliteral">&quot;application/json&quot;</span>, json);</div>
<div class="line">});</div>
<div class="ttc" id="aweb__server_8cpp_html_a48f3f185be3ea2d153c347a157b38d42"><div class="ttname"><a href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a></div><div class="ttdeci">WebServer server(80)</div></div>
</div><!-- fragment --><p>Puis appeler pendant <span class="tt"><a class="el" href="main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Fonction d&#39;initialisation Arduino. Initialise tous les modules et affiche l&#39;√©tat syst√®me.">setup()</a></span> apr√®s <span class="tt">setupWebServer()</span> : </p><div class="fragment"><div class="line">setupWebServer();</div>
<div class="line"><a class="code hl_function" href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a>.on(<span class="stringliteral">&quot;/api/temperature&quot;</span>, ...);</div>
</div><!-- fragment --><p>Voir <a href="https://github.com/espressif/arduino-esp32/tree/master/libraries/WebServer">documentation Arduino WebServer</a>.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md462"></a>
üìö Documentation technique</h1>
<p>Tous les fichiers sources et headers sont enti√®rement document√©s avec Doxygen (depuis v2.0.2)‚ÄØ:</p><ul>
<li>Chaque fonction, structure et module poss√®de une description d√©taill√©e et des notes d‚Äôoptimisation m√©moire.</li>
<li>Les recommandations pour l‚Äôutilisation de buffers statiques, la limitation des allocations dynamiques et la gestion efficace de la RAM sont pr√©sentes dans chaque fichier.</li>
<li>Voir le README pour l‚Äôutilisation de Doxygen et la g√©n√©ration de la documentation.</li>
</ul>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
