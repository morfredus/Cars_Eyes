<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cars Eyes: Web UI &amp; Networking</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Cars Eyes
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_docs_2_w_e_b___u_i.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Web UI &amp; Networking </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md406"></a></p>
<p><b>Version:</b> 1.6.2 <br  />
 <b>Minimum version:</b> 1.6.2 <br  />
 <b>Language:</b> English <br  />
</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md407"></a>
Web UI Overview</h1>
<p>The system includes a built-in web server serving on port <b>80</b>. Main endpoints:</p><ul>
<li><span class="tt">GET /</span> â€” HTML dashboard with system stats and animation controls</li>
<li><span class="tt">GET /status</span> â€” JSON API for programmatic access</li>
<li><span class="tt">GET /api/eyes/off</span> â€” Turn off all LEDs completely and stop all animations until another button is pressed</li>
<li><span class="tt">GET /api/eyes/animation?id=X</span> â€” Set animation (0-16)</li>
<li><span class="tt">GET /api/eyes/brightness?value=X</span> â€” Set brightness (0-255)</li>
<li><span class="tt">GET /api/eyes/scheme?id=X</span> â€” Set color scheme (0-4)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md408"></a>
Accessing the UI</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md409"></a>
By IP address</h2>
<p>Find the IP on the LCD screen or serial monitor: </p><div class="fragment"><div class="line">http://192.168.x.x/</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md410"></a>
By mDNS hostname</h2>
<p>Default hostname is <span class="tt">cars-eyes</span> (editable in <span class="tt"><a class="el" href="config_8h.html" title="ParamÃ¨tres utilisateur centralisÃ©s pour l&#39;application.">config.h</a></span>): </p><div class="fragment"><div class="line">http://cars-eyes.local/</div>
</div><!-- fragment --><p><b>Note:</b> mDNS requires <span class="tt">.local</span> domain support on your network (macOS/Linux usually support this; Windows may need Bonjour).</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md411"></a>
Dashboard</h1>
<p>The HTML page displays:</p><ul>
<li><b>Processor</b> â€” Chip model (e.g., "ESP32-S3")</li>
<li><b>CPU</b> â€” Frequency in MHz</li>
<li><b>Heap</b> â€” Free and total SRAM bytes</li>
<li><b>PSRAM</b> â€” Free and total external RAM (S3 only)</li>
<li><b>SSID</b> â€” Connected WiFi network name</li>
<li><b>IP</b> â€” Device IP address</li>
<li><b>OTA</b> â€” Button to open the OTA update page</li>
</ul>
<p>All values update when the page loads. The dashboard is responsive and works on mobile browsers.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md412"></a>
OTA Update Page (<span class="tt">/update</span>)</h1>
<ul>
<li>Reachable from the dashboard button or directly at <span class="tt"><a href="http://">http://</a>&lt;host&gt;/update</span></li>
<li>Upload a compiled <span class="tt">.bin</span> file; a progress bar shows upload status</li>
<li>On success the device reboots automatically and returns to the dashboard</li>
<li>Keep the device and your computer on the same WiFi; large uploads work best with strong signal</li>
<li>Security: no authentication by default; do not expose this endpoint on untrusted networks</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md413"></a>
JSON Status API</h1>
<p>Endpoint: <span class="tt"><a href="http://cars-eyes.local/status">http://cars-eyes.local/status</a></span></p>
<p>Response example: </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;project&quot;: &quot;Cars Eyes&quot;,</div>
<div class="line">  &quot;version&quot;: &quot;1.3.2&quot;,</div>
<div class="line">  &quot;chip&quot;: &quot;ESP32-S3&quot;,</div>
<div class="line">  &quot;cpu_mhz&quot;: 240,</div>
<div class="line">  &quot;heap_free&quot;: 256000,</div>
<div class="line">  &quot;heap_total&quot;: 320000,</div>
<div class="line">  &quot;psram_free&quot;: 8000000,</div>
<div class="line">  &quot;psram_total&quot;: 8388608,</div>
<div class="line">  &quot;ssid&quot;: &quot;MyNetwork&quot;,</div>
<div class="line">  &quot;ip&quot;: &quot;192.168.1.100&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Use this to log data, monitor the device remotely, or trigger alerts based on heap usage.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md414"></a>
Customizing the Dashboard</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md415"></a>
Change title and colors</h2>
<p>Edit <span class="tt">buildRootPage()</span> in <span class="tt"><a class="el" href="main_8cpp.html" title="Point d&#39;entrÃ©e principal du projet Cars Eyes.">src/main.cpp</a></span>: </p><div class="fragment"><div class="line">html += <span class="stringliteral">&quot;&lt;title&gt;My IoT Device&lt;/title&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;body{background:linear-gradient(135deg,#1a1a2e,#16213e);...}&quot;</span>;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md416"></a>
Add new stat card</h2>
<div class="fragment"><div class="line">html += <span class="stringliteral">&quot;&lt;div class=\&quot;card\&quot;&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;&lt;strong&gt;My Stat&lt;/strong&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;&lt;div&gt;&quot;</span> + String(myValue) + <span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;</div>
<div class="line">html += <span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md417"></a>
Change card styling</h2>
<p>Edit the CSS in <span class="tt">buildRootPage()</span>: </p><div class="fragment"><div class="line">html += <span class="stringliteral">&quot;.card{background:#0b1220;border:2px solid #green;...}&quot;</span>;</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md418"></a>
Monitoring &amp; Data Collection</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md419"></a>
Poll the JSON endpoint</h2>
<div class="fragment"><div class="line"># Bash example</div>
<div class="line">while true; do</div>
<div class="line">  curl -s http://esp32-template.local/status | jq .</div>
<div class="line">  sleep 10</div>
<div class="line">done</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md420"></a>
Log to cloud</h2>
<p>Add to <span class="tt"><a class="el" href="main_8cpp.html#afe461d27b9c48d5921c00d521181f12f" title="Boucle principale Arduino. GÃ¨re les tÃ¢ches pÃ©riodiques et le serveur web.">loop()</a></span>: </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lastLog = 0;</div>
<div class="line"><span class="keywordflow">if</span> (WiFi.isConnected() &amp;&amp; millis() - lastLog &gt; 60000) {</div>
<div class="line">    lastLog = millis();</div>
<div class="line">    String json = buildStatusJson();</div>
<div class="line">    <span class="comment">// Send json to your server</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md421"></a>
Trigger on conditions</h2>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (ESP.getFreeHeap() &lt; 50000) {</div>
<div class="line">    Serial.println(<span class="stringliteral">&quot;Low memory warning!&quot;</span>);</div>
<div class="line">    <span class="comment">// Send alert</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md422"></a>
WiFi Configuration</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md423"></a>
Add/remove networks</h2>
<p>Edit <span class="tt"><a class="el" href="secrets_8h.html" title="Stockage des identifiants sensibles (WiFi, API, etc.).">include/secrets.h</a></span>: </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code hl_variable" href="secrets_8h.html#a91c5976659d2c632043669eee67a0b2d">WIFI_NETWORKS</a>[][2] = {</div>
<div class="line">    {<span class="stringliteral">&quot;Home&quot;</span>, <span class="stringliteral">&quot;password1&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;Office&quot;</span>, <span class="stringliteral">&quot;password2&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;Mobile&quot;</span>, <span class="stringliteral">&quot;password3&quot;</span>}</div>
<div class="line">};</div>
<div class="ttc" id="asecrets_8h_html_a91c5976659d2c632043669eee67a0b2d"><div class="ttname"><a href="secrets_8h.html#a91c5976659d2c632043669eee67a0b2d">WIFI_NETWORKS</a></div><div class="ttdeci">const char * WIFI_NETWORKS[][2]</div><div class="ttdef"><b>Definition</b> secrets.h:15</div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md424"></a>
Adjust connection timeout</h2>
<p>Edit <span class="tt"><a class="el" href="config_8h.html" title="ParamÃ¨tres utilisateur centralisÃ©s pour l&#39;application.">include/config.h</a></span>: </p><div class="fragment"><div class="line">.wifiConnectTimeoutMs = 12000,  <span class="comment">// 12 seconds per attempt</span></div>
<div class="line">.maxWifiAttempts = 10,           <span class="comment">// Try up to 10 times</span></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md425"></a>
Manual connection</h2>
<p>The template uses <span class="tt">WiFiMulti</span> which automatically tries all configured networks. Check WiFi status in code: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (WiFi.isConnected()) {</div>
<div class="line">    Serial.println(<span class="stringliteral">&quot;SSID: &quot;</span> + String(WiFi.SSID()));</div>
<div class="line">    Serial.println(<span class="stringliteral">&quot;IP: &quot;</span> + WiFi.localIP().toString());</div>
<div class="line">}</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md426"></a>
mDNS Troubleshooting</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md427"></a>
Name not resolving</h2>
<ul>
<li>Ensure mDNS is enabled in config: <span class="tt">.mdnsHost = "esp32-template"</span></li>
<li>Check router doesn't block mDNS (port 5353 UDP)</li>
<li>Try <span class="tt">ping esp32-template.local</span> (add <span class="tt">.local</span> if needed)</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md428"></a>
Different hostname</h2>
<p>Edit <span class="tt"><a class="el" href="config_8h.html" title="ParamÃ¨tres utilisateur centralisÃ©s pour l&#39;application.">config.h</a></span>: </p><div class="fragment"><div class="line">.mdnsHost = <span class="stringliteral">&quot;my-device&quot;</span>  <span class="comment">// Will be accessible at my-device.local</span></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md429"></a>
Security Notes</h1>
<p><b>The template web server has NO authentication.</b> If exposed on an untrusted network:</p><ul>
<li>Disable web UI by setting <span class="tt">enableWebUi = false</span> in <span class="tt"><a class="el" href="config_8h.html" title="ParamÃ¨tres utilisateur centralisÃ©s pour l&#39;application.">config.h</a></span></li>
<li>OR restrict access at your router/firewall level</li>
<li>OR add basic HTTP authentication (not implemented by default)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md430"></a>
Performance</h1>
<ul>
<li>Web server runs on <b>core 0</b> alongside WiFi</li>
<li>Main firmware loop also runs; responsiveness depends on task complexity</li>
<li>JSON endpoint is lightweight; use for frequent polling</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md431"></a>
Advanced: Add custom endpoints</h1>
<div class="fragment"><div class="line"><a class="code hl_function" href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a>.on(<span class="stringliteral">&quot;/api/temperature&quot;</span>, HTTP_GET, []() {</div>
<div class="line">    String json = <span class="stringliteral">&quot;{\&quot;temp\&quot;:&quot;</span> + String(getTemperature()) + <span class="stringliteral">&quot;}&quot;</span>;</div>
<div class="line">    <a class="code hl_function" href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a>.send(200, <span class="stringliteral">&quot;application/json&quot;</span>, json);</div>
<div class="line">});</div>
<div class="ttc" id="aweb__server_8cpp_html_a48f3f185be3ea2d153c347a157b38d42"><div class="ttname"><a href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a></div><div class="ttdeci">WebServer server(80)</div></div>
</div><!-- fragment --><p>Then call during <span class="tt"><a class="el" href="main_8cpp.html#a4fc01d736fe50cf5b977f755b675f11d" title="Fonction d&#39;initialisation Arduino. Initialise tous les modules et affiche l&#39;Ã©tat systÃ¨me.">setup()</a></span> after <span class="tt">setupWebServer()</span>: </p><div class="fragment"><div class="line">setupWebServer();</div>
<div class="line"><a class="code hl_function" href="web__server_8cpp.html#a48f3f185be3ea2d153c347a157b38d42">server</a>.on(<span class="stringliteral">&quot;/api/temperature&quot;</span>, ...);</div>
</div><!-- fragment --><p>See <a href="https://github.com/espressif/arduino-esp32/tree/master/libraries/WebServer">Arduino WebServer documentation</a> for more.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md433"></a>
ðŸ“š Technical Documentation</h1>
<p>All source and header files are fully documented with Doxygen (since v2.0.2):</p><ul>
<li>Each function, structure, and module includes detailed descriptions and memory optimization notes.</li>
<li>Recommendations for static buffers, limited dynamic allocation, and RAM management are present in every file.</li>
<li>See README for Doxygen usage and documentation generation.</li>
</ul>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
